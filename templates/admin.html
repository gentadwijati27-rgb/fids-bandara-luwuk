<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<title>Admin FIDS Bandara Luwuk</title>
<link rel="stylesheet" href="/static/style.css">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
</head>

<body class="admin">

<h2 style="text-align:center;">ADMIN JADWAL PENERBANGAN</h2>

<!-- FORM TAMBAH JADWAL -->
<form method="POST" action="/add" class="admin-form">
  <select name="jenis" required>
    <option value="">Jenis</option>
    <option value="keberangkatan">Keberangkatan</option>
    <option value="kedatangan">Kedatangan</option>
  </select>

  <input type="text" name="maskapai" placeholder="Maskapai" required>
  <input type="text" name="kota" placeholder="Kota" required>

  <!-- JAM 24 JAM (AMAN, TANPA AM/PM) -->
  <select name="jam" required>
    {% for j in range(0,24) %}
    <option value="{{ "%02d"|format(j) }}">{{ "%02d"|format(j) }}</option>
    {% endfor %}
  </select>
  :
  <select name="menit" required>
    {% for m in range(0,60) %}
    <option value="{{ "%02d"|format(m) }}">{{ "%02d"|format(m) }}</option>
    {% endfor %}
  </select>

  <select name="status">
  <option value="TERJADWALKAN">TERJADWALKAN</option>
  <option value="ON TIME">ON TIME</option>
  <option value="EARLY">EARLY</option>

  <option value="CHECK-IN">CHECK-IN</option>
  <option value="BAGGAGE DROP">BAGGAGE DROP</option>
  <option value="SECURITY CHECK">SECURITY CHECK</option>
  <option value="FINAL CALL">FINAL CALL</option>
  <option value="GATE OPEN">GATE OPEN</option>
  <option value="GATE CLOSED">GATE CLOSED</option>
  <option value="BOARDING">BOARDING</option>
  <option value="LAST CALL">LAST CALL</option>

  <option value="DEPARTED">DEPARTED</option>
  <option value="AIRBORNE">AIRBORNE</option>

  <option value="DELAY">DELAY</option>
  <option value="RESCHEDULED">RESCHEDULED</option>
  <option value="DIVERTED">DIVERTED</option>
  <option value="RETURN TO GATE">RETURN TO GATE</option>

  <option value="LANDED">LANDED</option>
  <option value="ARRIVED">ARRIVED</option>
  <option value="AT GATE">AT GATE</option>
  <option value="BAGGAGE CLAIM">BAGGAGE CLAIM</option>
  <option value="CUSTOMS">CUSTOMS</option>
  <option value="COMPLETED">COMPLETED</option>

  <option value="CANCEL">CANCEL</option>
  <option value="CANCELLED DUE TO WEATHER">CANCELLED DUE TO WEATHER</option>
  <option value="CANCELLED TECHNICAL">CANCELLED TECHNICAL</option>
  <option value="EMERGENCY">EMERGENCY</option>
</select>


  <button type="submit">Tambah Jadwal</button>
</form>

<hr>

<!-- TABEL DATA -->
<table class="admin-table">
<tr>
  <th>Jenis</th>
  <th>Maskapai</th>
  <th>Kota</th>
  <th>Jam</th>
  <th>Status</th>
  <th>Aksi</th>
</tr>

{% for f in flights %}
<tr>
  <td>{{ f.get("jenis","-") }}</td>
  <td>{{ f.get("maskapai","-") }}</td>
  <td>{{ f.get("kota","-") }}</td>
  <td>{{ f.get("jam","-") }}</td>
  <td>{{ f.get("status","-") }}</td>
  <td>

    <!-- UPDATE STATUS -->
    <form method="POST" action="/update_status" style="display:inline;">
      <input type="hidden" name="id" value="{{ f.get('id') }}">
      <select name="status" onchange="this.form.submit()">
        {% for s in [
          "TERJADWALKAN","ON TIME","EARLY",
          "CHECK-IN","BAGGAGE DROP","SECURITY CHECK","FINAL CALL",
          "GATE OPEN","GATE CLOSED","BOARDING","LAST CALL",
          "DEPARTED","AIRBORNE",
          "DELAY","RESCHEDULED","DIVERTED","RETURN TO GATE",
          "LANDED","ARRIVED","AT GATE","BAGGAGE CLAIM","CUSTOMS","COMPLETED",
          "CANCEL","CANCELLED DUE TO WEATHER","CANCELLED TECHNICAL","EMERGENCY"
        ] %}

        <option value="{{ s }}" {% if f.get("status")==s %}selected{% endif %}>
          {{ s }}
        </option>
        {% endfor %}
      </select>
    </form>

    <!-- UPDATE JAM -->
    <form method="POST" action="/update_jam" style="display:inline;">
      <input type="hidden" name="id" value="{{ f.get('id') }}">
      {% set jam = f.get("jam","00:00").split(":") %}
      <select name="jam_jam">
        {% for j in range(0,24) %}
        <option value="{{ "%02d"|format(j) }}" {% if jam[0]==("%02d"|format(j)) %}selected{% endif %}>
          {{ "%02d"|format(j) }}
        </option>
        {% endfor %}
      </select>
      :
      <select name="jam_menit">
        {% for m in range(0,60) %}
        <option value="{{ "%02d"|format(m) }}" {% if jam|length>1 and jam[1]==("%02d"|format(m)) %}selected{% endif %}>
          {{ "%02d"|format(m) }}
        </option>
        {% endfor %}
      </select>

      <button type="submit">âœ”</button>
    </form>

    <!-- DELETE -->
    <a href="/delete/{{ f.get('id') }}" onclick="return confirm('Hapus jadwal?')">ðŸ—‘</a>

  </td>
</tr>
{% endfor %}
</table>

</body>
</html>

